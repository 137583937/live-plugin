apply plugin: 'groovy'

repositories {
	mavenCentral()
}

dependencies {
	compile group: 'org.codehaus.groovy', name: 'groovy-all', version: '2.3.9'
	compile group: 'junit', name: 'junit', version: '4.10'
	compile group: 'org.clojure', name: 'clojure', version: '1.7.0'
	compile group: 'org.scala-lang', name: 'scala-compiler', version: '2.11.7'
	compile group: 'org.scala-lang', name: 'scala-library', version: '2.11.7'
	compile group: 'org.scala-lang', name: 'scala-reflect', version: '2.11.7'
}

task downloadLibs(type: Copy) {
	from configurations.runtime
	into './lib'
}

task installLivePlugin() << {
	def version = new File("src/META-INF/plugin.xml").readLines()
			.find{ it.contains("<version>") }
	        .replaceFirst(".*<version>", "")
	        .replaceFirst("</version>.*", "")
	def localMavenPath = repositories.mavenLocal().url.path + "/liveplugin/live-plugin/"

	ant.copy(
			file: "LivePlugin.jar",
			toFile: "${localMavenPath}/${version}/live-plugin-${version}.jar"
	)

	println("Installed to local maven liveplugin version " + version)
}
